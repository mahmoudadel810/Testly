<div class="container">
  <div class="row justify-content-center align-items-center">
    <div class="col-md-6 col-12">
      <div class="img">
        <img
          src="image/Sign up-bro.svg"
          alt="sign up"
          class="img-fluid w-100"
          style="display: block"
        />
      </div>
    </div>

    <div class="col-md-6 col-12">
      <div class="auth-card">
        <!-- Show success message after registration -->
        @if (registerCompleted) {
          <div class="registration-success">
            <h2>Registration Successful!</h2>
            <div class="alert alert-success">
              {{ successMessage }}
            </div>

            <button class="btn-primaryCSS btn-block" routerLink="/login">
              Go to Login
            </button>
          </div>
        }

        <!-- Registration form -->
        @if (!registerCompleted) {
          <h2>Register as Student</h2>

          <form [formGroup]="registerForm" (ngSubmit)="onSubmit()">
            <div class="form-group">
              <label for="username">Username</label>
              <input
                type="text"
                id="username"
                formControlName="username"
                class="form-control"
              />
              @if (registerForm.get('username')?.invalid &&
              (registerForm.get('username')?.dirty ||
              registerForm.get('username')?.touched)) {
                <div class="error-text">
                  @if (registerForm.get('username')?.errors?.['required']) {
                    <div>Username is required</div>
                  } @if (registerForm.get('username')?.errors?.['minlength']) {
                    <div>Username must be at least 3 characters</div>
                  } @if
                  (registerForm.get('username')?.errors?.['invalidUsername']) {
                    <div>
                      Username must contain only letters, numbers, no space at the
                      start, and underscores.
                    </div>
                  }
                </div>
              }
            </div>

            <div class="form-group">
              <label for="email">Email</label>
              <input
                type="email"
                id="email"
                formControlName="email"
                class="form-control"
              />
              @if (registerForm.get('email')?.invalid &&
              (registerForm.get('email')?.dirty ||
              registerForm.get('email')?.touched)) {
                <div class="error-text">
                  @if (registerForm.get('email')?.errors?.['required']) {
                    <div>Email is required</div>
                  } @if (registerForm.get('email')?.errors?.['email']) {
                    <div>Please enter a valid email</div>
                  }
                </div>
              }
            </div>

            <div class="form-group">
              <label for="password">Password</label>
              <input
                type="password"
                id="password"
                formControlName="password"
                class="form-control"
              />
              @if (registerForm.get('password')?.invalid &&
              (registerForm.get('password')?.dirty ||
              registerForm.get('password')?.touched)) {
                <div class="error-text">
                  @if (registerForm.get('password')?.errors?.['required']) {
                    <div>Password is required</div>
                  } @if (registerForm.get('password')?.errors?.['minlength']) {
                    <div>Password must be at least 6 characters</div>
                  } @if
                  (registerForm.get('password')?.errors?.['invalidPassword']) {
                    <div>
                      Password must contain at least 1 uppercase letter, 1 number,
                      and a symbol (e.g., &#64;, #, $, etc.).
                    </div>
                  }
                </div>
              }
            </div>

            <div class="form-group">
              <label for="confirmPassword">Confirm Password</label>
              <input
                type="password"
                id="confirmPassword"
                formControlName="confirmPassword"
                class="form-control"
              />
              @if
              (registerForm.get('confirmPassword')?.errors?.['passwordMismatch']
              && registerForm.get('confirmPassword')?.dirty) {
                <div class="error-text">Passwords do not match</div>
              }
            </div>

            <button
              type="submit"
              class="btn-primaryCSS btn-block"
              [disabled]="registerForm.invalid || isLoading"
            >
              {{ isLoading ? "Registering..." : "Register" }}
            </button>
          </form>

          <div class="auth-footer">
            <p>
              Already have an account?
              <a routerLink="/login">Login</a>
            </p>
          </div>
        }
      </div>
    </div>
  </div>
</div>
